angular.module("templates-views",["/page/browser/browser.html","/page/browser/create-node.html","/page/browser/edit-node.html","/page/browser/edit-ttl.html","/page/browser/node-info.html","/page/stats/stats-detail.html","/page/stats/stats.html","/ui/breadcrumb.html","/ui/latency-graph.html","/ui/node-cog.html"]),angular.module("/page/browser/browser.html",[]).run(["$templateCache",function(a){a.put("/page/browser/browser.html",'<div class="ed-p-browser">\n\n  <co-nav-title title="Browser">\n    <a ng-click="openCreateModal()" href="#" class="co-m-primary-action">\n      <co-svg class="co-img-icon co-img-icon-light" src="/coreos.svg/icon-add.svg"></co-svg>Create Node</a>\n  </co-nav-title>\n\n  <div class="panel co-m-panel co-fx-box-shadow-heavy">\n    <div class="panel-body">\n\n      <div class="row">\n        <div class="col-lg-12 col-md-12 col-sm-12">\n\n          <co-breadcrumb callback="breadcrumbCallback({path: path})" path="currPath"></co-breadcrumb>\n\n          <table class="table table-hover co-m-table ed-m-node-table">\n            <thead>\n              <tr>\n                <th class="ed-m-node-table__cog-col">&nbsp;</th>\n                <th>Key</th>\n                <th class="ed-m-node-table__value-col">Value</th>\n                <th class="ed-m-node-table__ttl-col">TTL</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr ng-repeat="node in currNode.nodes | orderBy:\'key\' track by node.key"\n                ng-class="{\'ed-m-node-table__node-row\': !node.dir}"\n                ng-click="rowClick(node)"\n                class="co-m-table-interact-entire-element">\n                <td>\n                  <ed-node-cog node="node"></ed-node-cog>\n                </td>\n                <td>\n                  <a class="co-m-table__constrain-content" ng-if="node.dir" href="#">{{truncateKey(node.key)}}</a>\n                  <span class="co-m-table__constrain-content" ng-if="!node.dir">{{truncateKey(node.key)}}</span>\n                </td>\n                <td>\n                  <div class="co-m-table__constrain-content">\n                    <span co-highlight="node.value">{{node.value || \'--\'}}</span>\n                  </div>\n                </td>\n                <td>\n                  <span co-highlight="node.ttl">{{node.ttl || \'--\'}}</span>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n\n        </div>\n\n      </div>\n\n    </div>\n  </div>\n\n</div>\n')}]),angular.module("/page/browser/create-node.html",[]).run(["$templateCache",function(a){a.put("/page/browser/create-node.html",'<div class="ed-p-create-node">\n  <form ng-controller="CreateNodeFormCtrl" ng-submit="submit()" name="form" role="form">\n\n    <div class="modal-header">\n      <h4 class="modal-title">Create Node</h4>\n    </div>\n\n    <div class="modal-body">\n\n      <div class="row form-row">\n        <div class="col-sm-2">\n          <label for="ed-p-create-node__key" class="control-label">Key</label>\n        </div>\n        <div class="col-sm-10 input-group">\n          <span class="input-group-addon" ng-bind="keyInputPrefix"></span>\n          <input name="key"\n            required\n            spellcheck="false"\n            id="ed-p-create-node__key"\n            type="text"\n            ng-model="fields.key"\n            class="form-control"/>\n        </div>\n        <div class="col-sm-10 co-form-validation" ng-show="form.key.$dirty && form.key.$invalid">\n          <div ng-show="form.key.$error.required" class="co-m-message co-m-message--error">Key is required.</div>\n          <div ng-show="form.key.blur && form.key.$error.key" class="co-m-message co-m-message--error">Not a valid key.</div>\n        </div>\n      </div>\n\n      <div class="row form-row">\n        <div class="col-sm-2">\n          <strong class="control-label">Type</strong>\n        </div>\n        <div class="col-sm-10">\n          <div>\n            <input name="type"\n              id="ed-p-create-node__type-dir"\n              type="radio"\n              value="dir"\n              ng-model="fields.type"/>\n            <label class="co-m-radio-label" for="ed-p-create-node__type-dir">Directory</label>\n          </div>\n          <div>\n            <input name="type"\n              id="ed-p-create-node__type-key"\n              value="key"\n              type="radio"\n              ng-model="fields.type"/>\n            <label class="co-m-radio-label" for="ed-p-create-node__type-key">Key</label>\n          </div>\n        </div>\n      </div>\n\n      <div class="row form-row">\n        <div class="col-sm-2">\n          <label for="ed-p-create-node__value" class="control-label">Value</label>\n        </div>\n        <div class="col-sm-10">\n          <textarea ng-model="fields.value"\n            spellcheck="false"\n            ng-disabled="fields.type == \'dir\'"\n            rows="5"\n            name="value"\n            id="ed-p-create-node__value"\n            class="form-control"></textarea>\n        </div>\n      </div>\n\n      <div class="row form-row">\n        <div class="col-sm-2">\n          <label for="ed-p-create-node__ttl" class="control-label">TTL</label>\n        </div>\n        <div class="col-sm-10">\n          <input name="ttl"\n            id="ed-p-create-node__ttl"\n            type="number"\n            class="form-control ed-m-number-input"\n            min="0"\n            ng-blur="form.ttl.blur = true"\n            ng-model="fields.ttl"/>\n            Seconds\n        </div>\n      </div>\n\n    </div>\n\n    <div class="modal-footer" co-btn-bar complete-promise="requestPromise">\n      <co-error-message formatter="etcdApi" promise="requestPromise"></co-error-message>\n      <button type="submit" class="btn btn-primary">Save</button>\n      <button type="button" ng-click="cancel()" class="btn btn-link">Cancel</button>\n    </div>\n\n  </form>\n</div>\n')}]),angular.module("/page/browser/edit-node.html",[]).run(["$templateCache",function(a){a.put("/page/browser/edit-node.html",'<div class="ed-p-edit-node">\n  <form ng-controller="EditNodeFormCtrl" ng-submit="submit()" name="form" role="form">\n\n    <div class="modal-header">\n      <h4 class="modal-title">Modify Node</h4>\n    </div>\n\n    <div class="modal-body">\n      <div class="row form-row">\n        <div class="col-sm-2">\n          <label for="ed-p-edit-node__key" class="control-label">Key</label>\n        </div>\n        <div class="col-sm-10 input-group">\n          <kbd ng-bind="displayKey" id="ed-p-edit-node__key"></kbd>\n        </div>\n      </div>\n      <div class="row form-row">\n        <div class="col-sm-2">\n          <label for="ed-p-edit-node__value" class="control-label">Value</label>\n        </div>\n        <div class="col-sm-10">\n          <textarea ng-model="fields.value"\n            spellcheck="false"\n            rows="5"\n            name="value"\n            id="ed-p-edit-node__value"\n            class="form-control"></textarea>\n        </div>\n      </div>\n      <div class="row form-row">\n        <div class="col-sm-2">\n          <label for="ed-p-edit-node__ttl" class="control-label">TTL</label>\n        </div>\n        <div class="col-sm-10">\n          <input name="ttl"\n            id="ed-p-edit-node__ttl"\n            type="number"\n            class="form-control ed-m-number-input"\n            min="0"\n            ng-blur="form.ttl.blur = true"\n            ng-model="fields.ttl"/>\n            Seconds\n        </div>\n      </div>\n    </div>\n\n    <div class="modal-footer" co-btn-bar complete-promise="requestPromise">\n      <co-error-message formatter="etcdApi" promise="requestPromise"></co-error-message>\n      <button type="submit" class="btn btn-primary">Save</button>\n      <button type="button" ng-click="cancel()" class="btn btn-link">Cancel</button>\n    </div>\n\n  </form>\n</div>\n')}]),angular.module("/page/browser/edit-ttl.html",[]).run(["$templateCache",function(a){a.put("/page/browser/edit-ttl.html",'<div class="ed-p-edit-ttl">\n  <form ng-controller="EditTtlFormCtrl" ng-submit="submit()" name="form" role="form">\n\n    <div class="modal-header">\n      <h4 class="modal-title">Modify TTL</h4>\n    </div>\n\n    <div class="modal-body">\n      <div class="row form-row">\n        <div class="col-sm-2">\n          <label for="ed-p-edit-ttl__ttl" class="control-label">TTL</label>\n        </div>\n        <div class="col-sm-10">\n          <input name="ttl"\n            id="ed-p-edit-ttl__ttl"\n            type="number"\n            class="form-control ed-m-number-input"\n            min="0"\n            ng-blur="form.ttl.blur = true"\n            ng-model="fields.ttl"/>\n            Seconds\n        </div>\n      </div>\n    </div>\n\n    <div class="modal-footer" co-btn-bar complete-promise="requestPromise">\n      <co-error-message formatter="etcdApi" promise="requestPromise"></co-error-message>\n      <button type="submit" class="btn btn-primary">Save</button>\n      <button type="button" ng-click="cancel()" class="btn btn-link">Cancel</button>\n    </div>\n\n  </form>\n</div>\n')}]),angular.module("/page/browser/node-info.html",[]).run(["$templateCache",function(a){a.put("/page/browser/node-info.html",'<div class="ed-p-node-info">\n\n  <div class="modal-header">\n    <h4 class="modal-title">Node Details</h4>\n  </div>\n\n  <div class="modal-body">\n    <table id="ed-m-property-table" class="table">\n      <thead>\n        <tr>\n          <th>property</th>\n          <th>value</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr ng-repeat="key in objectKeys | orderBy:identityFn">\n          <td>{{key}}</td>\n          <td>{{node[key]}}</td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n\n  <div class="modal-footer">\n    <button type="button" ng-click="close()" class="btn btn-primary">Close</button>\n  </div>\n\n</div>\n')}]),angular.module("/page/stats/stats-detail.html",[]).run(["$templateCache",function(a){a.put("/page/stats/stats-detail.html",'<div class="ed-p-stats-info">\n\n  <div class="modal-header">\n    <h4 class="modal-title">Peer Stats</h4>\n  </div>\n\n  <div class="modal-body">\n    <table id="ed-m-property-table" class="table">\n      <thead>\n        <tr>\n          <th>property</th>\n          <th>value</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr ng-repeat="key in objectKeys | orderBy:identityFn">\n          <td>{{key}}</td>\n          <td>{{stats[key]}}</td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n\n  <div class="modal-footer">\n    <button type="button" ng-click="close()" class="btn btn-primary">Close</button>\n  </div>\n\n</div>\n')}]),angular.module("/page/stats/stats.html",[]).run(["$templateCache",function(a){a.put("/page/stats/stats.html",'<div class="ed-p-stats">\n  <co-nav-title title="Stats"></co-nav-title>\n  <div class="row">\n\n\n    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">\n      <div class="panel co-m-panel co-fx-box-shadow-heavy">\n        <div class="panel-body">\n          <h2>Peer Latency</h2>\n          <co-latency-graph peer-data="followers"></co-latency-graph>\n        </div>\n      </div>\n    </div>\n\n\n\n    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">\n      <div class="panel co-m-panel co-fx-box-shadow-heavy">\n        <div class="panel-body">\n          <div class="ed-p-stats__leader-container">\n            <h2>Leader</h2>\n            <dl>\n              <dt>Name</dt>\n              <dd><a ng-bind="leader.name" ng-click="openDetailModal(leader.name)" href="#"></a></dl>\n              <dt>Uptime</dt>\n              <dd ng-bind="leader.uptime"></dd>\n            </dl>\n          </div>\n\n          <h2>Followers</h2>\n          <table class="table co-m-table">\n            <thead>\n              <tr>\n                <th>Name</th>\n                <th>Latency</th>\n                <th>Raft Requests</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr ng-repeat="follower in followers | orderBy:\'name\' track by follower.name">\n                <td>\n                  <a href="#" ng-click="openDetailModal(follower.name)" ng-bind="follower.name"></a>\n                </td>\n                <td>\n                  <div class="ed-m-square-status" ng-class="getSquareStatusClass(follower)"></div>\n                  <span>{{follower.latency.current | number:1 }} ms</span>\n                </td>\n                <td>\n                  <span ng-highlight="follower.counts.fail">{{follower.counts.fail}} failures</span>,\n                  <span>{{follower.counts.success}} successes</span>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n\n        </div>\n      </div>\n    </div>\n\n\n\n\n  </div>\n</div>\n')}]),angular.module("/ui/breadcrumb.html",[]).run(["$templateCache",function(a){a.put("/ui/breadcrumb.html",'<ol class="breadcrumb ed-m-breadcrumb">\n  <li>\n    <a ng-if="pathParts.length" ng-click="goToRoot()" class="fa fa-home" href="#"></a>\n    <span ng-if="!pathParts.length" class="fa fa-home"></span>\n  </li>\n  <li ng-repeat="part in pathParts"\n    ng-class="{\'active\': $last}">\n    <a ng-if="!$last" ng-click="onClick(part)" href="#">{{part.name}}</a>\n    <span ng-if="$last">{{part.name}}</span>\n  </li>\n</ol>\n')}]),angular.module("/ui/latency-graph.html",[]).run(["$templateCache",function(a){a.put("/ui/latency-graph.html",'<div class="ed-m-latency-graph"></div>\n')}]),angular.module("/ui/node-cog.html",[]).run(["$templateCache",function(a){a.put("/ui/node-cog.html",'<div>\n  <co-cog options="cogDropdownOptions" size="small" anchor="left"></co-cog>\n</div>\n')}]),angular.module("etcd.module",[]),angular.module("etcd.ui",[]),angular.module("etcd.page",[]);var etcdDashboard=angular.module("etcd.dashboard",["coreos","etcd.module","etcd.ui","etcd.page","ngRoute","ngResource","ngAnimate","ui.bootstrap","templates-views","underscore","jquery","d3"]);etcdDashboard.config(["$routeProvider","$locationProvider","$httpProvider","$compileProvider","pollerSvcProvider","errorMessageSvcProvider","configSvcProvider",function(a,b,c,d,e,f,g){function h(a){return i+a}var i="/mod/dashboard";g.config({siteBasePath:i,libPath:"/mod/dashboard/static/coreos-web"}),b.html5Mode(!0),f.registerFormatter("etcdApi",function(a){return a.data&&a.data.message?a.data.message:"An error occurred."}),c.interceptors.push("interceptorErrorSvc"),e.settings({interval:5e3,maxRetries:5}),a.when(h("/"),{redirectTo:h("/browser")}).when(h("/browser"),{controller:"BrowserCtrl",templateUrl:"/page/browser/browser.html",title:"Key Browser"}).when(h("/stats"),{controller:"StatsCtrl",templateUrl:"/page/stats/stats.html",title:"Stats"}).otherwise({templateUrl:"/404.html",title:"Page Not Found (404)"})}]).run(["$http","$rootScope","$location","$window","$route","_","configSvc","toastSvc","CORE_EVENT",function(a,b,c,d,e,f,g,h,i){b.$on(i.POLL_ERROR,function(){h.error("Error polling for data.")}),b.$on(i.RESP_ERROR,function(a,b){var c="Request Error";b.data&&b.data.message&&(c=b.data.message),h.error(c)}),b.$on(i.PAGE_NOT_FOUND,function(){c.url(g.get().siteBaseUrl+"/404")})}]),angular.module("etcd.module").factory("etcdApiSvc",["$http","$q","$","_","pathSvc",function(a,b,c,d,e){function f(b){var d={ttl:b.ttl};return b.dir?d.dir=!0:d.value=b.value,l().then(function(f){return a({url:f+e.getFullKeyPath(b.key),data:c.param(d),method:"PUT",headers:{"Content-Type":"application/x-www-form-urlencoded"}})})}function g(b){var d={ttl:b.ttl,prevExist:!0};return b.dir?d.dir=!0:d.value=b.value,l().then(function(f){return a({url:f+e.getFullKeyPath(b.key),data:c.param(d),method:"PUT",headers:{"Content-Type":"application/x-www-form-urlencoded"}})})}function h(b){var c;return b.dir&&(c={dir:!0,recursive:!0}),l().then(function(d){return a({url:d+e.getFullKeyPath(b.key),method:"DELETE",params:c,headers:{"Content-Type":"application/x-www-form-urlencoded"}})})}function i(b){return a.get(e.getHost()+e.getFullKeyPath(b),{supressNotifications:!0}).then(function(a){return a.data.node})}function j(b){return a.get(e.getHost()+e.getStatFullKeyPath(b),{supressNotifications:!0})}function k(a){return i("/_etcd/machines/"+a).then(function(a){var b=decodeURIComponent(a.value);return b=b.replace(/&/g,'","').replace(/=/g,'":"'),b=JSON.parse('{"'+b+'"}'),b.etcd})}function l(){return n().then(function(a){return k(a.leaderName)})}function m(b){return k(b).then(function(b){return a.get(b+e.getStatFullKeyPath("self")).then(function(a){return a.data})})}function n(){return j("leader").then(function(a){var b={followers:[],leaderName:a.data.leader};return d.each(a.data.followers,function(a,c){a.name=c,b.followers.push(a)}),b})}return{fetch:i,fetchStat:j,fetchLeaderStats:n,fetchPeerDetailStats:m,getLeaderUri:l,create:f,save:g,"delete":h}}]),angular.module("etcd.module").factory("pathSvc",function(){var a="/v2/keys/",b="/v2/stats/";return{clean:function(a){var b=this.explode(a);return 0===b.length?"":b.join("/")},make:function(a){return"/"+a.join("/")},explode:function(a){var b=a.split("/");return b=b.filter(function(a){return""!==a})},tail:function(a){var b=this.explode(a);return b.length?b[b.length-1]:"/"},truncate:function(a,b){var c="/..";return b=b||10,a&&a.length?a.length<=b?a:c+a.substring(a.length-b+c.length,a.length):""},getFullKeyPath:function(b){var c="/"+this.clean(a+b);return c===a.substring(0,a.length-1)?a:c+"/"},getStatFullKeyPath:function(a){return"/"+this.clean(b+a)},getParent:function(a){var b=a.split("/");return 0===b.length?"/":(b.pop(),"/"+b.join("/"))},getHost:function(){  return"http://" + document.location.host;}}}),angular.module("etcd.module").constant("ETCD_EVENT",{NODE_DELETED:"etcd.node_deleted",NODE_CHANGED:"etcd.node_changed"}),angular.module("etcd.page").controller("BrowserCtrl",["$scope","$modal","etcdApiSvc","pathSvc","ETCD_EVENT","d3","pollerSvc",function(a,b,c,d,e,f,g){a.currPath="/",a.currNode=null,a.rowClick=function(b){b.dir&&(a.currPath=b.key)},a.truncateKey=function(a){return d.tail(a)},a.openCreateModal=function(c){b.open({templateUrl:"/page/browser/create-node.html",controller:"CreateNodeCtrl",resolve:{key:f.functor(c||a.currPath)}})},a.$on(e.NODE_CHANGED,function(b,c){var e=d.getParent(c.key);a.refreshNode(e)}),a.$on(e.NODE_DELETED,function(b,c){var e=d.getParent(c.key);a.refreshNode(e)}),a.breadcrumbCallback=function(b){a.currPath=b.path},a.refreshNode=function(b){a.currPath===b?a.fetchNode():a.currPath=b},a.fetchNode=function(){return c.fetch(a.currPath).then(function(b){a.currNode=b})},a.$watch("currPath",function(b){return b&&""!==b?void a.fetchNode():void(a.currPath="/")}),g.register("nodePoller",{fn:a.fetchNode,scope:a})}]),angular.module("etcd.page").controller("CreateNodeCtrl",["$scope","$rootScope","$modalInstance","_","ETCD_EVENT","etcdApiSvc","pathSvc","key",function(a,b,c,d,e,f,g,h){a.key=h,a.keyInputPrefix="/"===h?"/":g.truncate(h,20)+"/",a.save=function(d){a.requestPromise=f.create(d).then(function(){b.$broadcast(e.NODE_CHANGED,d),c.close(d)})},a.cancel=function(){c.dismiss("cancel")}}]),angular.module("etcd.page").controller("CreateNodeFormCtrl",["$scope","pathSvc",function(a,b){a.fields={key:"",value:"",type:"key",ttl:null},a.submit=function(){var c={};c.key=b.clean(a.key+"/"+a.fields.key),c.dir="dir"===a.fields.type,c.ttl=a.fields.ttl?parseInt(a.fields.ttl,10):null,c.dir||(c.value=a.fields.value),a.save(c)}}]),angular.module("etcd.page").controller("EditNodeCtrl",["$scope","$rootScope","$modalInstance","_","ETCD_EVENT","etcdApiSvc","pathSvc","node",function(a,b,c,d,e,f,g,h){a.node=h,a.displayKey=g.truncate(h.key,50)+"/",a.save=function(d){a.requestPromise=f.save(d).then(function(){b.$broadcast(e.NODE_CHANGED,d),c.close(d)})},a.cancel=function(){c.dismiss("cancel")}}]),angular.module("etcd.page").controller("EditNodeFormCtrl",["$scope","pathSvc",function(a){a.fields={value:a.node.value||"",ttl:a.node.ttl||""},a.submit=function(){var b={key:a.node.key,value:a.fields.value,ttl:a.fields.ttl?parseInt(a.fields.ttl,10):null};a.save(b)}}]),angular.module("etcd.page").controller("NodeInfoCtrl",["$scope","$modalInstance","_","node",function(a,b,c,d){a.node=d,a.objectKeys=c.without(c.keys(d),"value","$$hashKey"),a.identityFn=c.identity,a.close=function(){b.dismiss("close")}}]),angular.module("etcd.page").controller("EditTtlCtrl",["$scope","$rootScope","$modalInstance","_","ETCD_EVENT","etcdApiSvc","node",function(a,b,c,d,e,f,g){a.node=g,a.save=function(d){g.ttl=d,a.requestPromise=f.save(g).then(function(){b.$broadcast(e.NODE_CHANGED,g),c.close(g)})},a.cancel=function(){c.dismiss("cancel")}}]),angular.module("etcd.page").controller("EditTtlFormCtrl",["$scope",function(a){a.fields={ttl:a.node.ttl||""},a.submit=function(){a.save(a.fields.ttl)}}]),angular.module("etcd.page").controller("StatsCtrl",["$scope","$modal","etcdApiSvc","pollerSvc",function(a,b,c,d){a.followers=null,a.leader=null,a.leaderName=null,a.parseLatencyStats=function(b){a.followers=b.followers,a.leaderName=b.leaderName},a.fetchLeaderDetails=function(){return c.fetchPeerDetailStats(a.leaderName).then(function(b){a.leader={name:a.leaderName,uptime:b.leaderInfo.uptime}})},a.$watch("leaderName",function(b){b&&(d.kill("leaderDetailsPoller"),d.register("leaderDetailsPoller",{fn:a.fetchLeaderDetails,scope:a,interval:5e3}))}),a.openDetailModal=function(a){b.open({templateUrl:"/page/stats/stats-detail.html",controller:"StatsDetailCtrl",resolve:{peerName:d3.functor(a)}})},a.getSquareStatusClass=function(a){return a.latency.current<25?"ed-m-square-status--green":a.latency.current<60?"ed-m-square-status--orange":"ed-m-square-status--red"},d.register("statsPoller",{fn:c.fetchLeaderStats,then:a.parseLatencyStats,scope:a,interval:500})}]),angular.module("etcd.page").controller("StatsDetailCtrl",["$scope","$modalInstance","_","etcdApiSvc","peerName",function(a,b,c,d,e){d.fetchPeerDetailStats(e).then(function(b){a.stats=b,a.objectKeys=c.without(c.keys(a.stats),"$$hashKey")}),a.identityFn=c.identity,a.close=function(){b.dismiss("close")}}]),angular.module("etcd.ui").directive("coBreadcrumb",["_","pathSvc",function(a,b){return{templateUrl:"/ui/breadcrumb.html",restrict:"E",replace:!0,scope:{path:"=",callback:"&"},link:function(c){c.goToRoot=function(){c.callback({path:"/"})},c.onClick=function(d){var e,f;e=c.pathParts.slice(0,c.pathParts.indexOf(d)+1),f=b.make(a.pluck(e,"name")),c.callback({path:f})},c.$watch("path",function(a){c.pathParts=b.explode(a).map(function(a){return{name:a}})})}}}]),angular.module("etcd.ui").directive("edNodeCog",["$modal","$rootScope","etcdApiSvc","toastSvc","ETCD_EVENT",function(a,b,c,d,e){return{templateUrl:"/ui/node-cog.html",restrict:"E",replace:!0,scope:{node:"="},controller:["$scope",function(d){function f(){return d.node.dir?'Are you sure you want to delete the directory "'+d.node.key+'" and all of its keys?':'Are you sure you ant to delete "'+d.node.key+'"'}d.cogDropdownOptions=[{label:"View Details...",callback:function(){a.open({templateUrl:"/page/browser/node-info.html",controller:"NodeInfoCtrl",resolve:{node:d3.functor(d.node)}})},weight:100},{label:"Delete Node...",callback:function(){a.open({templateUrl:"/coreos.ui/confirm-modal/confirm-modal.html",controller:"ConfirmModalCtrl",resolve:{title:d3.functor("Delete Node"),message:f,btnText:d3.functor("Delete"),errorFormatter:d3.functor("etcdApi"),executeFn:_.identity.bind(null,function(){return c["delete"](d.node).then(function(){b.$broadcast(e.NODE_DELETED,d.node)})})}})},weight:300}],d.cogDropdownOptions.push(d.node.dir?{label:"Modify TTL...",callback:function(){a.open({templateUrl:"/page/browser/edit-ttl.html",controller:"EditTtlCtrl",resolve:{node:d3.functor(d.node)}})},weight:200}:{label:"Modify Node...",callback:function(){a.open({templateUrl:"/page/browser/edit-node.html",controller:"EditNodeCtrl",resolve:{node:d3.functor(d.node)}})},weight:200})}]}}]),angular.module("etcd.ui").value("graphConfig",{padding:{top:10,left:5,bottom:40,right:10},data:[{name:"stats"},{name:"thresholds",values:[50,100]}],scales:[{name:"y",type:"ordinal",range:"height",domain:{data:"stats",field:"index"}},{name:"x",range:"width",domainMin:0,domainMax:100,nice:!0,zero:!0,domain:{data:"stats",field:"data.latency.current"}},{name:"color",type:"linear",domain:[10,50,100,1e9],range:["#00DB24","#FFC000","#c40022","#c40022"]}],axes:[{type:"x",scale:"x",ticks:6,name:"Latency (ms)"},{type:"y",scale:"y",properties:{ticks:{stroke:{value:"transparent"}},majorTicks:{stroke:{value:"transparent"}},labels:{fill:{value:"transparent"}},axis:{stroke:{value:"#333"},strokeWidth:{value:1}}}}],marks:[{type:"rect",from:{data:"stats"},properties:{enter:{x:{scale:"x",value:0},x2:{scale:"x",field:"data.latency.current"},y:{scale:"y",field:"index",offset:-1},height:{value:3},fill:{scale:"color",field:"data.latency.current"}}}},{type:"symbol",from:{data:"stats"},properties:{enter:{x:{scale:"x",field:"data.latency.current"},y:{scale:"y",field:"index"},size:{value:50},fill:{value:"#000"}}}}]}),angular.module("etcd.ui").directive("coLatencyGraph",["etcdApiSvc","$","d3","_","graphConfig",function(a,b,c,d,e){return{templateUrl:"/ui/latency-graph.html",restrict:"E",replace:!0,scope:{peerData:"="},link:function(a,b){function c(){var c=b.width()-f,d=300;vg.parse.spec(e,function(e){e({el:b[0],data:{stats:a.peerData}}).width(c).height(d).update()})}var f=60;a.$watch("peerData",function(a){d.isEmpty(a)||c()}),b.on("$destroy",function(){})}}}]);